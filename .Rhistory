library(readxl)
library(tidyr)
library(tidyverse)
library(reshape2)
rm(list=ls())
breeding <- read_xlsx("Dataset/14_22사육.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:43, values_to = "breeding_count", names_to = "age")  %>%
rename("kind" = "구분...2", "gender" = "구분...3") %>%
mutate(
month = parse_number(month),
type = "breeding",
age = parse_number(age)
)
slaughter <- read_xlsx("Dataset/14_22도축.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:26, values_to = "slaughter_count", names_to = "age") %>%
mutate(
month = parse_number(month),
age = parse_number(age),
type = "slaughter",
age = ifelse(age == 20, "total_20", age)
) %>%
rename("kind" = "구분...2", "gender" = "구분...3")
breeding_under20 <- breeding %>%
mutate(
age = ifelse(age <=20, "total_20", age)
) %>%
group_by(year, month, kind, gender, age, type) %>%
summarise(breeding_count = sum(breeding_count, na.rm=TRUE))
breeding <- merge(breeding, breeding_under20, all=TRUE)
rm(list=ls())
breeding <- read_xlsx("Dataset/14_22사육.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:43, values_to = "breeding_count", names_to = "age")  %>%
rename("kind" = "구분...2", "gender" = "구분...3") %>%
mutate(
month = parse_number(month),
type = "breeding",
age = parse_number(age)
)
slaughter <- read_xlsx("Dataset/14_22도축.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:26, values_to = "slaughter_count", names_to = "age") %>%
mutate(
month = parse_number(month),
age = parse_number(age),
type = "slaughter",
age = ifelse(age == 20, "total_20", age)
) %>%
rename("kind" = "구분...2", "gender" = "구분...3")
View(slaughter)
breeding_under20 <- breeding %>%
mutate(
age = ifelse(age <=20, "total_20", age)
) %>%
group_by(year, month, kind, gender, age, type) %>%
summarise(breeding_count = sum(breeding_count, na.rm=TRUE))
breeding <- merge(breeding, breeding_under20, all=TRUE)
total <- merge(breeding, slaughter, by=c('year'='year', 'month'='month', 'kind' = 'kind', 'gender'='gender', 'age'='age'), all=TRUE) %>%
mutate(
rate = (slaughter_count/(breeding_count+slaughter_count))
) %>%
select(-c(type.x,type.y))
test <- total %>%
filter(year == 2022) %>%
View()
train <- total %>%
filter(year != 2022)
rate <- train %>%
group_by(kind, gender, age) %>%
summarise(mean_rate = mean(rate, na.rm=TRUE))
View(rate)
View(slaughter)
View(breeding)
View(breeding_under20)
breeding_under20 <- breeding %>%
mutate(
age = ifelse(age <=20, "total_20", age)
) %>%
group_by(year, month, kind, gender, age, type) %>%
summarise(breeding_count = sum(breeding_count, na.rm=TRUE)) %>%
filter(age = "total_20")
breeding_under20 <- breeding %>%
mutate(
age = ifelse(age <=20, "total_20", age)
) %>%
group_by(year, month, kind, gender, age, type) %>%
summarise(breeding_count = sum(breeding_count, na.rm=TRUE)) %>%
filter(age == "total_20")
View(breeding_under20)
breeding <- merge(breeding, breeding_under20, all=TRUE)
View(breeding)
rm(list=ls())
breeding <- read_xlsx("Dataset/14_22사육.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:43, values_to = "breeding_count", names_to = "age")  %>%
rename("kind" = "구분...2", "gender" = "구분...3") %>%
mutate(
month = parse_number(month),
type = "breeding",
age = parse_number(age)
)
slaughter <- read_xlsx("Dataset/14_22도축.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:26, values_to = "slaughter_count", names_to = "age") %>%
mutate(
month = parse_number(month),
age = parse_number(age),
type = "slaughter",
age = ifelse(age == 20, "total_20", age)
) %>%
rename("kind" = "구분...2", "gender" = "구분...3")
breeding_under20 <- breeding %>%
mutate(
age = ifelse(age <=20, "total_20", age)
) %>%
group_by(year, month, kind, gender, age, type) %>%
summarise(breeding_count = sum(breeding_count, na.rm=TRUE)) %>%
filter(age == "total_20")
breeding <- merge(breeding, breeding_under20, all=TRUE)
rm(list=ls())
breeding <- read_xlsx("Dataset/14_22사육.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:43, values_to = "breeding_count", names_to = "age")  %>%
rename("kind" = "구분...2", "gender" = "구분...3") %>%
mutate(
month = parse_number(month),
type = "breeding",
age = parse_number(age)
)
slaughter <- read_xlsx("Dataset/14_22도축.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:26, values_to = "slaughter_count", names_to = "age") %>%
mutate(
month = parse_number(month),
age = parse_number(age),
type = "slaughter",
age = ifelse(age == 20, "total_20", age)
) %>%
rename("kind" = "구분...2", "gender" = "구분...3")
breeding_under20 <- breeding %>%
mutate(
age = ifelse(age <=20, "total_20", age)
) %>%
group_by(year, month, kind, gender, age, type) %>%
summarise(breeding_count = sum(breeding_count, na.rm=TRUE)) %>%
filter(age == "total_20")
View(breeding)
breeding <- merge(breeding, breeding_under20, all=TRUE)
total <- merge(breeding, slaughter, by=c('year'='year', 'month'='month', 'kind' = 'kind', 'gender'='gender', 'age'='age'), all=TRUE) %>%
mutate(
rate = (slaughter_count/(breeding_count+slaughter_count))
) %>%
select(-c(type.x,type.y))
View(total)
library(readxl)
library(tidyr)
rm(list=ls())
breeding <- read_xlsx("Dataset/14_22사육.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:43, values_to = "breeding_count", names_to = "age")  %>%
rename("kind" = "구분...2", "gender" = "구분...3") %>%
mutate(
month = parse_number(month),
type = "breeding",
age = parse_number(age)
)
slaughter <- read_xlsx("Dataset/14_22도축.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:26, values_to = "slaughter_count", names_to = "age") %>%
mutate(
month = parse_number(month),
age = parse_number(age),
type = "slaughter",
age = ifelse(age == 20, "total_20", age)
) %>%
rename("kind" = "구분...2", "gender" = "구분...3")
breeding_under20 <- breeding %>%
mutate(
age = ifelse(age <=20, "total_20", age)
) %>%
group_by(year, month, kind, gender, age, type) %>%
summarise(breeding_count = sum(breeding_count, na.rm=TRUE)) %>%
filter(age == "total_20")
View(breeding)
View(breeding_under20)
breeding <- merge(breeding, breeding_under20, all=TRUE)
unique(slaughter$age)
View(train)
total <- merge(breeding, slaughter, by=c('year'='year', 'month'='month', 'kind' = 'kind', 'gender'='gender', 'age'='age'), all=TRUE) %>%
mutate(
rate = (slaughter_count/(breeding_count+slaughter_count))
) %>%
select(-c(type.x,type.y))
test <- total %>%
filter(year == 2022) %>%
View()
train <- total %>%
filter(year != 2022)
View(train)
total %>%
filter(kind=="한우" & gender=="암")
total %>%
filter(kind=="한우" & gender=="암") %>%
View()
total %>%
filter(kind=="한우" & gender=="암" & year ==2014 & month ==1)
total %>%
filter(kind=="한우" & gender=="암" & year ==2014 & month ==1) %>%
View()
total %>%
filter(kind=="한우" & gender=="암" & year ==2014 & month ==1) %>%
View()
total %>%
filter(kind=="한우" & gender=="암" & year ==2014 & month ==2) %>%
View()
total %>%
filter(kind=="한우" & gender=="암" & year ==2014 & month ==2) %>%
mutate(rate_100 = rate * 100)
total %>%
filter(kind=="한우" & gender=="암" & year ==2014 & month ==2) %>%
mutate(rate_100 = rate * 100) %>%
View()
rate <- train %>%
group_by(kind, gender, age) %>%
summarise(mean_rate = mean(rate, na.rm=TRUE))
View(rate)
total %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
mutate(rate_100 = rate * 100) %>%
View()
rate <- train %>%
group_by(kind, gender, age) %>%
summarise(mean_rate = mean(rate, na.rm=TRUE))
View(rate)
View(rate)
total %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate)
total %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
View()
total %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
unique(age)
total %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
unique(total$age)
total %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) -> predictJan
View(predictJan)
rm(list=ls())
breeding <- read_xlsx("Dataset/14_22사육.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:43, values_to = "breeding_count", names_to = "age")  %>%
rename("kind" = "구분...2", "gender" = "구분...3") %>%
mutate(
month = parse_number(month),
type = "breeding",
age = parse_number(age)
)
View(breeding)
total %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) -> predictJan
View(predictJan)
library(readxl)
library(tidyr)
library(tidyverse)
library(reshape2)
rm(list=ls())
breeding <- read_xlsx("Dataset/14_22사육.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:43, values_to = "breeding_count", names_to = "age")  %>%
rename("kind" = "구분...2", "gender" = "구분...3") %>%
mutate(
month = parse_number(month),
type = "breeding",
age = parse_number(age)
)
slaughter <- read_xlsx("Dataset/14_22도축.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:26, values_to = "slaughter_count", names_to = "age") %>%
mutate(
month = parse_number(month),
age = parse_number(age),
type = "slaughter",
age = ifelse(age == 20, "total_20", age)
) %>%
rename("kind" = "구분...2", "gender" = "구분...3")
slaughter <- read_xlsx("Dataset/14_22도축.xlsx", sheet = 2) %>%
separate(구분...1, sep = "년", into = c("year", "month")) %>%
filter(구분...3 != '소계') %>%
pivot_longer(cols= 5:26, values_to = "slaughter_count", names_to = "age") %>%
mutate(
month = parse_number(month),
age = parse_number(age),
type = "slaughter",
age = ifelse(age == 20, 200, age)
) %>%
rename("kind" = "구분...2", "gender" = "구분...3")
breeding_under20 <- breeding %>%
mutate(
age = ifelse(age <=20, "total_20", age)
) %>%
group_by(year, month, kind, gender, age, type) %>%
summarise(breeding_count = sum(breeding_count, na.rm=TRUE)) %>%
filter(age == "total_20")
breeding_under20 <- breeding %>%
mutate(
age = ifelse(age <=20, 200, age)
) %>%
group_by(year, month, kind, gender, age, type) %>%
summarise(breeding_count = sum(breeding_count, na.rm=TRUE)) %>%
filter(age == "total_20")
View(breeding)
breeding_under20 <- breeding %>%
mutate(
age = ifelse(age <=20, 200, age)
) %>%
group_by(year, month, kind, gender, age, type) %>%
summarise(breeding_count = sum(breeding_count, na.rm=TRUE)) %>%
filter(age == "total_20")
breeding_under20 <- breeding %>%
mutate(
age = ifelse(age <=20, 200, age)
) %>%
group_by(year, month, kind, gender, age, type) %>%
summarise(breeding_count = sum(breeding_count, na.rm=TRUE)) %>%
filter(age == 200)
View(breeding_under20)
breeding <- merge(breeding, breeding_under20, all=TRUE)
total <- merge(breeding, slaughter, by=c('year'='year', 'month'='month', 'kind' = 'kind', 'gender'='gender', 'age'='age'), all=TRUE) %>%
mutate(
rate = (slaughter_count/(breeding_count+slaughter_count))
) %>%
select(-c(type.x,type.y))
test <- total %>%
filter(year == 2022) %>%
View()
train <- total %>%
filter(year != 2022)
rate <- train %>%
group_by(kind, gender, age) %>%
summarise(mean_rate = mean(rate, na.rm=TRUE))
View(rate)
total %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) -> predictJan
View(predictJan)
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) -> predictJan
View(predictJan)
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) -> predictJan
View(predictJan)
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = lag(breeding_count, order_by = age)
)
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = lag(breeding_count, order_by = age)
) %>%
View()
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = lag(breeding_count, 1:35, order_by = age)
) %>%
View()
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = lag(breeding_count[1:35],order_by = age)
) %>%
View()
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = lag(breeding_count, n=1, order_by = age)
) %>%
View()
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = ifelse(age<=37, lag(breeding_count,n=1, order_by = age), breeding_count)
) %>%
View()
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = ifelse(age<=37, lag(breeding_count,n=1, order_by = age), breeding_count)
) %>%
View()
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = ifelse(age<=37, lag(breeding_count,n=1, order_by = age), breeding_count)
predict_slaughter = predict_breeding * mean_rate
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = ifelse(age<=37, lag(breeding_count,n=1, order_by = age), breeding_count),
predict_slaughter = predict_breeding * mean_rate
) %>%
View()
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = ifelse(age<=37, lag(breeding_count,n=1, order_by = age), breeding_count),
predict_slaughter = predict_breeding * mean_rate
) -> predictJan
test %>%
filter(kind == "한우" & gender == "암" & year == 2022 & month == 1) %>%
View()
test %>%
# filter(kind == "한우" & gender == "암" & year == 2022 & month == 1) %>%
View()
test <- total %>%
filter(year == 2022)
test %>%
# filter(kind == "한우" & gender == "암" & year == 2022 & month == 1) %>%
View()
test %>%
filter(kind == "한우" & gender == "암" & year == 2022 & month == 1) %>%
View()
test %>%
filter(kind == "한우" & gender == "암" & year == 2022 & month == 1) %>%
select(slaughter_count) %>%
View()
test %>%
filter(kind == "한우" & gender == "암" & year == 2022 & month == 1) %>%
# select(slaughter_count) %>%
View()
View(predictJan)
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = ifelse(age<=37, lag(breeding_count,n=1, order_by = age), breeding_count),
predict_slaughter = predict_breeding * mean_rate
) %>%
select(-c(breeding_count, slaughter_count)) -> View()
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = ifelse(age<=37, lag(breeding_count,n=1, order_by = age), breeding_count),
predict_slaughter = predict_breeding * mean_rate
) %>%
select(-c(breeding_count, slaughter_count)) %>%
View()
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = ifelse(age<=37, lag(breeding_count,n=1, order_by = age), breeding_count),
predict_slaughter = predict_breeding * mean_rate
) %>%
select(-c(breeding_count, slaughter_count, rate, mean_rate)) %>%
View()
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = ifelse(age<=37, lag(breeding_count,n=1, order_by = age), breeding_count),
predict_slaughter = predict_breeding * mean_rate
) %>%
select(-c(breeding_count, slaughter_count, rate, mean_rate)) -> predictJan
View(predictJan)
train %>%
filter(kind=="한우" & gender=="암" & year == 2021 & month == 12) %>%
merge(rate) %>%
mutate(
predict_breeding = ifelse(age<=37, lag(breeding_count,n=1, order_by = age), breeding_count),
predict_slaughter = predict_breeding * mean_rate
) %>%
select(-c(breeding_count, slaughter_count, rate, mean_rate)) -> predictJan
View(predictJan)
